'use strict';

var utils = require('../utils');
var common = require('./common');
var ConfigurationChangeBase = require('../base-messages/ConfigurationChangeBase');

module.exports = ConfigurationChangeMessage;

function ConfigurationChangeMessage(content, transport) {
  ConfigurationChangeBase.call(this, content, transport);
}

require('util').inherits(ConfigurationChangeMessage, ConfigurationChangeBase);

ConfigurationChangeMessage.prototype.attribute = function (attribute) {
  utils.validate.object(attribute, 'attribute');
  utils.validate.notEmptyString(attribute.name, 'attribute name');
  utils.validate.attributeName(this._content.attributes, attribute.name);
  utils.validate.string(attribute.old, 'attribute old value');
  utils.validate.string(attribute.new, 'attribute new value');

  this._content.attributes.push(attribute);
  return this;
};

ConfigurationChangeMessage.prototype.logPrepare = common.logPrepare;
ConfigurationChangeMessage.prototype.logSuccess = common.logSuccess;
ConfigurationChangeMessage.prototype.logFailure = common.logFailure;
