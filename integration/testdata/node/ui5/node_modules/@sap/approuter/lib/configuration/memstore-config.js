'use strict';

var MemoryStore = require('../backend-request/memstore');
var logoutProvider = require('../middleware/logout-provider');

exports.getMemoryStore = function (app) {
  var memoryStore = new MemoryStore({
    timeout: app.get('mainRouterConfig').sessionTimeout
  });

  memoryStore.on('timeout', function (session) {
    logoutProvider.sessionTimeoutLogout(session, app);
  });

  memoryStore.on('update', function (sessionId, timeout) {
    app.approuter.emit('update', sessionId, timeout);
  });

  return memoryStore;
};
